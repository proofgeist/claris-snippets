{"id":"c13a2ba7-5dd5-4848-80dd-501f45389fc0","name":"handle field data update example","type":"script","snippet":"<fmxmlsnippet type=\"FMObjectList\"><Script includeInMenu=\"False\" SiriShortcutVisible=\"False\" runFullAccess=\"False\" id=\"2025\" name=\"handle fieldData update\"><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>/##</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text> handle fieldData update</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text> @param {object} json</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text> @param {object} json.callback</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text> @param {object} json.fieldData</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text> @param {object}</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text> @HISTORY 2023-11-28 alondra.torres-navarro@proofgeist.com - updated</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>#/</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>Required properties</Text></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[Get ( ScriptParameter )]]></Calculation></Value><Name>$json</Name></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[JSONGetElement ( $json ; \"callback\" )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$callback</Name></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>optional Properties</Text></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[JSONGetElement ( $json ; \"data\" )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$data</Name></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>the callback may already know the web viewer name. if not, write the name here.</Text></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[\"web\"]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$webViewerName</Name></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>--------------------  UPDATE INFO HERE -------------------</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>get a result in any way you know how!</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>Any way you know how that doesn&apos;t leave the layout.</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text> Parse fieldData from the parameter</Text></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[JSONGetElement ( $data ; \"fieldData\" )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$fieldData</Name></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[JSONGetElement ( $data ; \"layout\" )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$layout</Name></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[JSONGetElement ( $data ; \"fieldData\" )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$$fieldData</Name></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text> validate</Text></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[isValidJSON ( $data )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$isValidJSON</Name></Step><Step enable=\"True\" id=\"68\" name=\"If\"><Calculation><![CDATA[not $isValidJSON]]></Calculation></Step><Step enable=\"True\" id=\"103\" name=\"Exit Script\"></Step><Step enable=\"True\" id=\"70\" name=\"End If\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text> Set context in new window</Text></Step><Step enable=\"True\" id=\"205\" name=\"Open Transaction\"><Option state=\"False\"></Option><ESSForceCommit state=\"False\"></ESSForceCommit></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[Random]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$windowName</Name></Step><Step enable=\"True\" id=\"122\" name=\"New Window\"><LayoutDestination value=\"LayoutNameByCalc\"></LayoutDestination><Name><Calculation><![CDATA[$windowName]]></Calculation></Name><NewWndStyles DimParentWindow=\"Yes\" Toolbars=\"No\" MenuBar=\"No\" Style=\"Card\" Close=\"Yes\" Minimize=\"No\" Maximize=\"No\" Resize=\"No\" Styles=\"3222339600\"></NewWndStyles><Layout><Calculation><![CDATA[$layout]]></Calculation></Layout></Step><Step enable=\"True\" id=\"207\" name=\"Revert Transaction\"><Option state=\"True\"></Option><Condition><Calculation><![CDATA[GetAsBoolean ( Get ( LastError ) )]]></Calculation></Condition><ErrorCode><Calculation><![CDATA[Get ( LastError )]]></Calculation></ErrorCode></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text> find record to edit</Text></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[JSONGetElement ( $fieldData ; \"Id\" )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$Id</Name></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"22\" name=\"Enter Find Mode\"><Pause state=\"False\"></Pause><Restore state=\"False\"></Restore></Step><Step enable=\"True\" id=\"147\" name=\"Set Field By Name\"><Result><Calculation><![CDATA[\"==\" & $Id]]></Calculation></Result><TargetName><Calculation><![CDATA[Get ( LayoutTableName ) & \"::Id\"]]></Calculation></TargetName></Step><Step enable=\"True\" id=\"28\" name=\"Perform Find\"><Restore state=\"False\"></Restore></Step><Step enable=\"True\" id=\"207\" name=\"Revert Transaction\"><Option state=\"True\"></Option><Condition><Calculation><![CDATA[GetAsBoolean ( Get ( LastError ) )]]></Calculation></Condition><ErrorCode><Calculation><![CDATA[401]]></Calculation></ErrorCode></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[ValueCount ( JSONListKeys ( $fieldData ; \"\" ) )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$length</Name></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[1]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$index</Name></Step><Step enable=\"True\" id=\"71\" name=\"Loop\"><FlushType value=\"Always\"></FlushType></Step><Step enable=\"True\" id=\"72\" name=\"Exit Loop If\"><Calculation><![CDATA[$index > $length]]></Calculation></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[GetValue ( JSONListKeys ( $fieldData ; \"\" ) ; $index )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$key</Name></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[JSONGetElement ( $fieldData ; $key )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$value</Name></Step><Step enable=\"True\" id=\"68\" name=\"If\"><Calculation><![CDATA[$key â‰  \"Id\"]]></Calculation></Step><Step enable=\"True\" id=\"147\" name=\"Set Field By Name\"><Result><Calculation><![CDATA[$value]]></Calculation></Result><TargetName><Calculation><![CDATA[Case ( \r\rPatternCount ( $key ; \"::\" ) ; $key ;\rGet ( LayoutTableName ) & \"::\" & $key\r\r )]]></Calculation></TargetName></Step><Step enable=\"True\" id=\"70\" name=\"End If\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[$index + 1]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$index</Name></Step><Step enable=\"True\" id=\"73\" name=\"End Loop\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"206\" name=\"Commit Transaction\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>check for error</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>set $code</Text></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[Get ( LastError )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$code</Name></Step><Step enable=\"True\" id=\"68\" name=\"If\"><Calculation><![CDATA[IsEmpty ( $code )]]></Calculation></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[0]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$code</Name></Step><Step enable=\"True\" id=\"70\" name=\"End If\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"121\" name=\"Close Window\"><LimitToWindowsOfCurrentFile state=\"True\"></LimitToWindowsOfCurrentFile><Window value=\"ByName\"></Window><Name><Calculation><![CDATA[$windowName]]></Calculation></Name></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>$result must be an object.</Text></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[\"{}\"]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$response</Name></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[JSONSetElement ( \"{}\" ; \r\r[ \"response\" ; $response ; JSONObject ]  ;\r[\"messages[0].code\" ;$code ; JSONNumber ] ;\r[\"messages[0].message\" ; \"OK\" ; JSONString ] \r\r )]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$result</Name></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>--------------------  UPDATE INFO HERE -------------------</Text></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"><Text>if $callback already has web viewer name, remove that property declaration here.</Text></Step><Step enable=\"True\" id=\"141\" name=\"Set Variable\"><Value><Calculation><![CDATA[JSONSetElement ( $callback ; [\"result\"; $result; JSONObject ]; [\"webViewerName\"; $webViewerName; JSONString ])]]></Calculation></Value><Repetition><Calculation><![CDATA[1]]></Calculation></Repetition><Name>$callback</Name></Step><Step enable=\"True\" id=\"89\" name=\"# (comment)\"></Step><Step enable=\"True\" id=\"1\" name=\"Perform Script\"><Calculation><![CDATA[$callback]]></Calculation><Script id=\"1906\" name=\"SendCallBack\"></Script></Step></Script></fmxmlsnippet>","tags":["javascript"],"description":"an example of how to update data in FileMaker from the fmfetch library","customXML":false,"dynamicFields":[]}